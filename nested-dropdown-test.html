<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=1200, initial-scale=1.0" />
    <title>Nested Dropdown Test</title>
    <link rel="stylesheet" href="final.css?v=12" />
    <script src="force-overflow-fix.js"></script>
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        min-width: 1200px;
      }

      .test-container {
        margin-top: 120px;
        padding: 20px;
        background: #f0f0f0;
        min-height: 500px;
      }

      /* Force all dropdowns visible for testing */
      .sub-menu {
        display: block !important;
      }

      /* Visual debugging */
      .site-header {
        border: 3px solid red;
        background: rgba(255, 0, 0, 0.1) !important;
      }
      .header-container {
        border: 3px solid blue;
        background: rgba(0, 0, 255, 0.1) !important;
      }
      .sub-menu {
        border: 2px solid purple !important;
        background: rgba(255, 255, 0, 0.9) !important;
      }

      /* Different colors for nested levels */
      .sub-menu .sub-menu {
        border: 2px solid orange !important;
        background: rgba(255, 165, 0, 0.9) !important;
      }

      .sub-menu .sub-menu .sub-menu {
        border: 2px solid green !important;
        background: rgba(0, 255, 0, 0.9) !important;
      }

      .results-panel {
        position: fixed;
        top: 100px;
        right: 20px;
        width: 350px;
        background: white;
        border: 2px solid #333;
        padding: 15px;
        font-size: 12px;
        z-index: 5000;
        max-height: 80vh;
        overflow-y: auto;
      }
    </style>
  </head>
  <body>
    <header id="masthead" class="site-header">
      <div class="header-container">
        <div class="site-branding">
          <h1 style="margin: 0; color: #333">Nested Dropdown Test</h1>
        </div>
        <div class="header-controls">
          <nav
            class="main-navigation flex items-center"
            style="display: flex !important"
          >
            <div class="nav-menu-container">
              <ul class="menu">
                <li class="menu-item menu-item-has-children">
                  <a href="#" style="color: #333; text-decoration: none"
                    >Services</a
                  >
                  <ul class="sub-menu">
                    <li><a href="#">Web Design</a></li>
                    <li class="menu-item-has-children">
                      <a href="#">Development</a>
                      <ul class="sub-menu">
                        <li><a href="#">Frontend Development</a></li>
                        <li>
                          <a href="#"
                            >Backend Development with Very Long Text That Should
                            Not Wrap</a
                          >
                        </li>
                        <li class="menu-item-has-children">
                          <a href="#">Specialized Services</a>
                          <ul class="sub-menu">
                            <li><a href="#">React Development</a></li>
                            <li>
                              <a href="#"
                                >Vue.js Development with Extremely Long Text
                                Content That Should Be Handled Properly</a
                              >
                            </li>
                            <li><a href="#">Node.js Backend Services</a></li>
                          </ul>
                        </li>
                        <li><a href="#">Full Stack Development</a></li>
                      </ul>
                    </li>
                    <li><a href="#">Consulting</a></li>
                    <li><a href="#">Support Services</a></li>
                  </ul>
                </li>
                <li class="menu-item menu-item-has-children">
                  <a href="#" style="color: #333; text-decoration: none"
                    >About</a
                  >
                  <ul class="sub-menu">
                    <li><a href="#">Our Team</a></li>
                    <li>
                      <a href="#">Company History and Background Information</a>
                    </li>
                    <li class="menu-item-has-children">
                      <a href="#">Locations</a>
                      <ul class="sub-menu">
                        <li><a href="#">Main Office</a></li>
                        <li><a href="#">Remote Offices Around the World</a></li>
                        <li><a href="#">Satellite Locations</a></li>
                      </ul>
                    </li>
                  </ul>
                </li>
                <li class="menu-item">
                  <a href="#" style="color: #333; text-decoration: none"
                    >Contact</a
                  >
                </li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </header>

    <div class="results-panel">
      <h3>Nested Dropdown Test</h3>
      <div id="test-results"></div>
      <button
        onclick="runNestedTest()"
        style="margin-top: 10px; padding: 8px; font-size: 12px"
      >
        Re-run Test
      </button>
    </div>

    <div class="test-container">
      <h2>Nested Dropdown Visual Test</h2>

      <div
        style="
          margin: 20px 0;
          padding: 15px;
          background: white;
          border-radius: 5px;
        "
      >
        <h3>Expected Behavior:</h3>
        <ul>
          <li>
            üü° <strong>Yellow dropdowns</strong> (level 1) should appear below
            menu items
          </li>
          <li>
            üü† <strong>Orange dropdowns</strong> (level 2) should appear to the
            right of yellow dropdowns
          </li>
          <li>
            üü¢ <strong>Green dropdowns</strong> (level 3) should appear to the
            right of orange dropdowns
          </li>
          <li>
            üìù <strong>Long text</strong> should be truncated with ellipsis
            (...)
          </li>
          <li>
            üìç <strong>No dropdowns</strong> should appear at the left edge of
            the screen
          </li>
        </ul>
      </div>

      <div
        style="
          margin: 20px 0;
          padding: 15px;
          background: #e8f4f8;
          border-radius: 5px;
        "
      >
        <h3>Test Cases:</h3>
        <ol>
          <li>
            <strong>Services ‚Üí Development</strong> - Check orange dropdown
            positioning
          </li>
          <li>
            <strong>Services ‚Üí Development ‚Üí Specialized Services</strong> -
            Check green dropdown positioning
          </li>
          <li>
            <strong>Long text items</strong> - Check text truncation with
            ellipsis
          </li>
          <li>
            <strong>About ‚Üí Locations</strong> - Check second menu nested
            dropdowns
          </li>
        </ol>
      </div>
    </div>

    <script>
      function runNestedTest() {
        const dropdowns = document.querySelectorAll(".sub-menu");
        let results = '<div style="font-size: 12px;">';

        results += "<strong>Dropdown Analysis:</strong><br>";
        results += `Found ${dropdowns.length} dropdown menus<br><br>`;

        dropdowns.forEach((dropdown, index) => {
          const rect = dropdown.getBoundingClientRect();
          const level = dropdown.closest(".sub-menu .sub-menu .sub-menu")
            ? 3
            : dropdown.closest(".sub-menu .sub-menu")
              ? 2
              : 1;

          results += `<div style="margin: 8px 0; padding: 8px; border-left: 3px solid ${level === 1 ? "#fbbf24" : level === 2 ? "#f97316" : "#22c55e"};">`;
          results += `<strong>Level ${level} Dropdown ${index + 1}:</strong><br>`;
          results += `Position: ${Math.round(rect.left)}, ${Math.round(rect.top)}<br>`;
          results += `Size: ${Math.round(rect.width)}√ó${Math.round(rect.height)}<br>`;

          // Check if positioned at left edge (problematic)
          if (rect.left < 50) {
            results += '<span style="color: red;">‚ö†Ô∏è At left edge!</span><br>';
          } else {
            results += '<span style="color: green;">‚úì Good position</span><br>';
          }

          results += "</div>";
        });

        // Check text truncation
        const longTextLinks = document.querySelectorAll(".sub-menu a");
        let longTextCount = 0;
        longTextLinks.forEach((link) => {
          if (link.textContent.length > 30) {
            longTextCount++;
          }
        });

        results += "<br><strong>Text Handling:</strong><br>";
        results += `Found ${longTextCount} long text items<br>`;
        results += "Check visually for ellipsis (...) truncation<br>";

        results += "</div>";

        document.getElementById("test-results").innerHTML = results;

        console.log("=== NESTED DROPDOWN TEST ===");
        dropdowns.forEach((dropdown, index) => {
          const rect = dropdown.getBoundingClientRect();
          console.log(
            `Dropdown ${index + 1}: left=${rect.left}, top=${rect.top}, width=${rect.width}, height=${rect.height}`
          );
        });
      }

      // Run test on load
      document.addEventListener("DOMContentLoaded", function () {
        setTimeout(runNestedTest, 1000);
      });
    </script>
  </body>
</html>
