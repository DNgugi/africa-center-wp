@tailwind base;
@tailwind components;
@tailwind utilities;

/* Enable smooth scrolling for all anchor links */
html {
  scroll-behavior: smooth;
}

/* Back to top button styles */
#back-to-top {
  @apply transition-all duration-300;
  animation: bounceOnce 2s ease-out;
  animation-delay: 1s;
  border-radius: 50% !important;
  aspect-ratio: 1 / 1;
}

#back-to-top:hover {
  @apply transform -translate-y-1 scale-110;
}

/* Search functionality styles */
.search-toggle {
  display: flex;
  align-items: center; /* Center align with nav items */
}

.search-toggle a {
  @apply no-underline;
}

.search-toggle a:hover {
  @apply transform scale-110 no-underline;
  text-decoration: none !important;
}

/* Mobile search icon - keep inline with toggle button (no special positioning) */
@media (max-width: 1023px) {
  .mobile-controls .search-toggle {
    position: static;
    transform: none;
  }

  .mobile-controls .search-toggle a {
    transform: none;
    position: relative;
  }
}

.search-form {
  @apply transition-all duration-300;
}

.search-field:focus {
  @apply ring-2 ring-primary-ochre ring-opacity-50;
}

.search-submit:hover {
  @apply transform scale-105;
}

/* Search results highlighting */
mark {
  @apply bg-yellow-200 px-1 rounded;
}

/* Search filters styling */
.search-form select:focus,
.search-form input:focus {
  @apply ring-2 ring-primary-ochre ring-opacity-50 border-primary-ochre;
}

/* Pagination styles */
.pagination {
  @apply flex justify-center items-center space-x-2 mt-8;
}

.pagination a,
.pagination span {
  @apply px-4 py-2 rounded-lg transition-colors duration-200;
}

.pagination a {
  @apply bg-white text-primary-blue border border-gray-300 hover:bg-primary-blue hover:text-white;
}

.pagination .current {
  @apply bg-primary-blue text-white border border-primary-blue;
}

/* Bounce animation that plays once */
@keyframes bounceOnce {
  0%,
  20%,
  53%,
  80%,
  100% {
    animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
    transform: translate3d(0, 0, 0);
  }
  40%,
  43% {
    animation-timing-function: cubic-bezier(0.755, 0.05, 0.855, 0.06);
    transform: translate3d(0, -8px, 0);
  }
  70% {
    animation-timing-function: cubic-bezier(0.755, 0.05, 0.855, 0.06);
    transform: translate3d(0, -4px, 0);
  }
  90% {
    transform: translate3d(0, -2px, 0);
  }
}

@layer base {
  /* Base typography styles */
  html {
    font-family: "Open Sans", ui-sans-serif, system-ui, sans-serif;
    @apply text-base leading-relaxed;
  }

  body {
    @apply text-neutral-darkest bg-neutral-lightest leading-relaxed;
    line-height: 1.7;
  }

  /* Headings */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: "Montserrat", ui-sans-serif, system-ui, sans-serif;
    @apply font-bold leading-tight text-primary-blue mb-4;
  }

  h1 {
    @apply text-3xl md:text-4xl lg:text-5xl mb-6;
  }

  h2 {
    @apply text-2xl md:text-3xl lg:text-4xl mb-5;
  }

  h3 {
    @apply text-xl md:text-2xl lg:text-3xl mb-4 text-primary-terracotta;
  }

  h4 {
    @apply text-lg md:text-xl lg:text-2xl mb-3 text-primary-green;
  }

  h5 {
    @apply text-base md:text-lg lg:text-xl mb-3;
  }

  h6 {
    @apply text-sm md:text-base lg:text-lg mb-2 uppercase tracking-wide;
  }

  /* Paragraphs */
  p {
    @apply mb-6 text-base md:text-lg leading-relaxed text-neutral-darkest;
  }

  /* Links */
  a {
    @apply text-primary-light-blue hover:text-primary-blue transition-colors duration-200;
  }

  a:hover {
    @apply underline;
  }

  /* Lists */
  ul,
  ol {
    @apply mb-6 pl-6;
  }

  ul {
    @apply list-disc;
  }

  ol {
    @apply list-decimal;
  }

  /* Remove list styles from navigation menus */
  .main-navigation ul,
  .menu,
  .sub-menu {
    @apply list-none;
  }

  .main-navigation li,
  .menu li,
  .sub-menu li {
    @apply mb-0;
  }

  li {
    @apply mb-2 text-base md:text-lg leading-relaxed;
  }

  li > ul,
  li > ol {
    @apply mb-2 mt-2;
  }

  /* Blockquotes */
  blockquote {
    @apply border-l-4 border-primary-ochre pl-6 py-4 mb-6 italic text-neutral-dark bg-secondary-sand/30 rounded-r-lg;
  }

  blockquote p {
    @apply mb-4 last:mb-0;
  }

  blockquote cite {
    @apply block text-sm text-neutral-medium mt-2 not-italic;
  }

  blockquote cite::before {
    content: "â€” ";
  }

  /* Remove all blockquote styling for .no-bq-style */
  .no-bq-style {
    border: none !important;
    padding: 0 !important;
    margin: 0 0 1.5em 0 !important;
    background: none !important;
    color: inherit !important;
    font-style: normal !important;
    font-size: inherit !important;
    box-shadow: none !important;
    border-radius: 0 !important;
  }

  /* Code */
  code {
    @apply bg-neutral-light px-2 py-1 rounded text-sm font-mono text-neutral-darkest;
  }

  pre {
    @apply bg-neutral-darkest text-neutral-lightest p-4 rounded-lg overflow-x-auto mb-6;
  }

  pre code {
    @apply bg-transparent text-inherit p-0;
  }

  /* Tables */
  table {
    @apply w-full mb-6 border-collapse;
  }

  th,
  td {
    @apply border border-neutral-light p-3 text-left;
  }

  th {
    @apply bg-secondary-sand font-semibold text-neutral-darkest;
  }

  tbody tr:nth-child(even) {
    @apply bg-neutral-lightest/50;
  }

  /* Images */
  img {
    @apply max-w-full h-auto rounded-lg;
  }

  figure {
    @apply mb-6;
  }

  figcaption {
    @apply text-sm text-neutral-medium mt-2 text-center italic;
  }

  /* Horizontal rule */
  hr {
    @apply border-0 border-t-2 border-neutral-light my-8;
  }

  /* Form elements */
  input,
  textarea,
  select {
    @apply border border-neutral-light rounded-lg px-4 py-2 text-base focus:outline-none focus:ring-2 focus:ring-primary-blue focus:border-transparent;
  }

  label {
    @apply block font-semibold mb-2 text-neutral-darkest;
  }

  button,
  input[type="submit"],
  input[type="button"] {
    @apply bg-primary-blue text-white px-6 py-2 rounded-lg hover:bg-primary-blue/90 transition-colors duration-200 cursor-pointer font-medium;
  }

  /* WordPress Content Styles */
  .entry-content {
    @apply text-base md:text-lg leading-relaxed;
  }

  .entry-content h1,
  .entry-content h2,
  .entry-content h3,
  .entry-content h4,
  .entry-content h5,
  .entry-content h6 {
    @apply font-heading font-bold leading-tight mb-4;
  }

  .entry-content h1 {
    @apply text-3xl md:text-4xl text-primary-blue mb-6;
  }

  .entry-content h2 {
    @apply text-2xl md:text-3xl text-primary-blue mb-5;
  }

  .entry-content h3 {
    @apply text-xl md:text-2xl text-primary-terracotta mb-4;
  }

  .entry-content h4 {
    @apply text-lg md:text-xl text-primary-green mb-3;
  }

  .entry-content h5 {
    @apply text-base md:text-lg text-primary-blue mb-3;
  }

  .entry-content h6 {
    @apply text-sm md:text-base text-primary-blue mb-2 uppercase tracking-wide;
  }

  /* WordPress alignment classes */
  .aligncenter {
    @apply mx-auto block;
  }

  .alignleft {
    @apply float-left mr-6 mb-4;
  }

  .alignright {
    @apply float-right ml-6 mb-4;
  }

  .alignwide,
  .alignfull {
    @apply w-full;
  }

  /* WordPress captions */
  .wp-caption {
    @apply max-w-full;
  }

  .wp-caption-text {
    @apply text-sm text-neutral-medium mt-2 text-center italic;
  }

  /* WordPress galleries */
  .gallery {
    @apply grid gap-4 mb-6;
  }

  .gallery-columns-2 {
    @apply grid-cols-2;
  }

  .gallery-columns-3 {
    @apply grid-cols-3;
  }

  .gallery-columns-4 {
    @apply grid-cols-2 md:grid-cols-4;
  }

  .gallery-item {
    @apply text-center;
  }

  .gallery-caption {
    @apply text-sm text-neutral-medium mt-2 italic;
  }
}

@layer components {
  /* Sidebar Styles */
  .widget-area {
    @apply space-y-6;
  }

  .widget {
    @apply bg-white rounded-lg shadow p-6;
  }

  .widget-title {
    @apply text-lg font-semibold mb-4 text-gray-900;
  }

  .widget ul {
    @apply space-y-2;
  }

  .widget ul li {
    @apply text-gray-700;
  }

  .widget ul li a {
    @apply hover:text-primary-blue transition-colors;
  }

  /* Search widget */
  .widget_search .search-form {
    @apply flex;
  }

  .widget_search .search-field {
    @apply flex-1 rounded-l-lg border-gray-300;
  }

  .widget_search .search-submit {
    @apply px-4 py-2 bg-primary-blue text-white rounded-r-lg hover:bg-primary-blue/90 transition-colors;
  }

  /* Header Styles */
  .header-style-transparent {
    @apply bg-transparent absolute w-full z-10;
  }

  .header-style-transparent .site-title a,
  .header-style-transparent .main-navigation a {
    @apply text-white;
  }

  .header-style-overlay {
    @apply bg-black/50 absolute w-full z-10;
  }

  .header-style-overlay .site-title a,
  .header-style-overlay .main-navigation a {
    @apply text-white;
  }

  .header-style-minimal {
    @apply py-4 bg-white shadow-sm;
  }

  /* Screen reader text */
  .sr-only {
    @apply absolute w-px h-px p-0 -m-px overflow-hidden whitespace-nowrap border-0;
    clip: rect(0, 0, 0, 0);
  }

  /* Content Width Classes */
  .content-width-default {
    @apply max-w-6xl mx-auto px-4;
  }

  .content-width-narrow {
    @apply max-w-4xl mx-auto px-4;
  }

  .content-width-wide {
    @apply max-w-7xl mx-auto px-4;
  }

  .content-width-full {
    @apply w-full;
  }
}

@layer components {
  .btn {
    @apply inline-flex items-center justify-center px-6 py-3 rounded-full font-medium text-base transition-all duration-300;
    text-decoration: none !important; /* Override global link underline */
  }

  .btn:hover {
    text-decoration: none !important; /* Ensure no underline on hover */
    transform: scale(1.05);
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
  }

  .btn-primary {
    @apply btn bg-primary-ochre text-white hover:bg-primary-ochre/90 hover:text-white shadow-lg;
  }

  .btn-primary:hover {
    box-shadow: 0 8px 20px rgba(251, 191, 36, 0.25);
  }

  .btn-outline {
    @apply btn border-2 border-white text-white hover:bg-white/10 hover:text-white;
  }

  .btn-outline:hover {
    box-shadow: 0 8px 20px rgba(255, 255, 255, 0.15);
  }

  .btn-blue {
    @apply btn bg-primary-blue text-white hover:bg-primary-light-blue hover:text-white shadow-lg;
  }

  .btn-blue:hover {
    box-shadow: 0 8px 20px rgba(59, 130, 246, 0.25);
  }

  .btn-ochre {
    @apply btn bg-primary-ochre text-white hover:bg-primary-ochre/90 hover:text-white shadow-lg;
  }

  .btn-ochre:hover {
    box-shadow: 0 8px 20px rgba(251, 191, 36, 0.25);
  }

  .btn-small {
    @apply px-4 py-2 text-sm;
  }

  .btn-large {
    @apply px-8 py-4 text-lg;
  }
}

:root {
  --header-height: 80px;
  --page-padding-top: 80px;
}

.site-header {
  @apply bg-white fixed top-0 left-0 right-0 z-[100];
  height: var(
    --header-height
  ); /* Use CSS variable for dynamic height adjustment */
  padding: 0 16px; /* Minimal edge padding */
  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
  /* Keep this simple - no overflow handling here at all */
}

/* WordPress Admin Bar Integration - Prevent header overlap */
.admin-bar .site-header {
  top: 32px; /* Standard admin bar height on desktop */
}

/* Account for mobile admin bar */
@media screen and (max-width: 782px) {
  .admin-bar .site-header {
    top: 46px; /* WordPress uses 46px on mobile */
  }
}

/* Very small screens where admin bar becomes absolute */
@media screen and (max-width: 600px) {
  .admin-bar .site-header {
    position: fixed;
  }

  /* When scrolled down on mobile, WP changes the admin bar to absolute positioning
     so we need to restore the header to the top */
  .admin-bar.mobile-scrolled .site-header {
    top: 0;
  }
}

/* Scrolled state - more transparency and stronger shadow */
.site-header.header-scrolled {
  background-color: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(8px);
  box-shadow:
    0 4px 6px -1px rgba(0, 0, 0, 0.1),
    0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

#page {
  padding-top: var(
    --page-padding-top
  ); /* Using dedicated page padding variable */
  margin-top: 0; /* Remove any margin that could cause gaps */
}

/* Logo sizing constraints */
.custom-logo-link {
  @apply block;
}

.custom-logo,
.site-branding img {
  @apply w-auto object-contain;
  /* Mobile: 50px max height */
  max-height: 50px;
}

@media (min-width: 768px) and (max-width: 1023px) {
  .custom-logo,
  .site-branding img {
    /* Tablet: 60px max height */
    max-height: 60px;
  }
}

@media (min-width: 1024px) {
  .custom-logo,
  .site-branding img {
    /* Desktop: 70px max height - increased to fit in 80px header */
    max-height: 70px;
  }
}

.menu-toggle {
  @apply lg:hidden bg-transparent p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100;
}

/* Header layout styles */
.header-container {
  @apply flex items-center justify-between w-full h-full;
  max-width: 100%;
  /* No overflow settings - let default browser behavior handle this */
}

/* Two-line layout fallback for desktop */
@media (min-width: 1024px) {
  .header-container.two-line-layout {
    @apply flex-col justify-center;
    gap: 1rem; /* Increased gap for better visual separation */
    padding: 0.75rem 0; /* Add vertical padding */
  }

  .header-container.two-line-layout .site-branding {
    @apply w-full justify-center;
    margin-top: 1rem; /* Move logo down one final bit */
  }

  .header-container.two-line-layout .header-controls {
    @apply w-full justify-center;
    margin-top: -1rem; /* Move navigation + search up one final bit */
  }

  .header-container.two-line-layout .main-navigation .menu {
    @apply justify-center;
    gap: 1rem; /* Smaller gap for two-line layout */
  }

  /* Special handling for two-line layout dropdown positioning */
  .header-container.two-line-layout
    .menu
    > .menu-item-has-children
    > .sub-menu {
    margin-top: 0.75rem; /* More space below menu in two-line layout */
  }

  /* Increase logo size for two-line layout since we have more space */
  .header-container.two-line-layout .custom-logo,
  .header-container.two-line-layout .site-branding img {
    max-height: 85px; /* Increased from 70px for two-line layout */
  }
}

.site-branding {
  @apply flex items-center flex-shrink-0;
}

.header-controls {
  @apply flex items-center;
}

.mobile-controls {
  @apply gap-2;
}

/* Desktop navigation layout */
.main-navigation {
  @apply items-center;
  /* Remove max-width constraint to allow dropdowns to extend */
}

.main-navigation .nav-menu-container {
  @apply flex items-center;
  /* Remove max-width constraint to allow dropdowns to extend */
}

.main-navigation .menu {
  @apply flex items-center justify-end;
  gap: 1.5rem; /* Space between nav items */
  flex-wrap: nowrap; /* Prevent wrapping, let JS handle overflow */
  /* Remove max-width constraint to allow dropdowns to extend */
  min-width: 0; /* Allow shrinking */
}

.main-navigation .menu a {
  @apply whitespace-nowrap text-sm font-medium text-gray-700 hover:text-gray-900 px-3 py-2 transition-colors duration-200;
  flex-shrink: 0; /* Don't shrink nav items */
}

/* Navigation container styles */
.nav-menu-container {
  /* Desktop: flex-1 and visible */
  @apply flex-1 block;
}

@media (max-width: 1023px) {
  .nav-menu-container {
    /* Mobile/Tablet: hidden by default, positioned for overlay */
    @apply hidden;
  }

  .toggled .nav-menu-container {
    /* Mobile/Tablet: show when toggled */
    @apply block;
  }
}

.menu {
  @apply list-none lg:p-2;
}

/* Desktop menu styles */
@media (min-width: 1024px) {
  .menu {
    @apply flex justify-between;
    gap: 2.5rem; /* Increased gap to spread items across available width */
  }
}

/* Navigation link styles */
.menu > li > a {
  @apply whitespace-nowrap; /* Prevent text wrapping in top-level menu only */
}

/* Allow submenu items to wrap */
.sub-menu a {
  white-space: normal;
  word-break: break-word;
  line-height: 1.4;
  padding: 8px 10px;
  display: block;
  width: 100%;
  font-size: inherit; /* Inherit from parent to maintain consistency */
}

/* Desktop navigation font sizing - smaller for better fit */
@media (min-width: 1024px) {
  /* Apply consistent text size to all menu items, including submenus */
  .menu a,
  .sub-menu a {
    @apply text-sm font-medium; /* Smaller, more compact navigation text */
    font-size: 0.875rem; /* Explicit rem size for consistency */
  }

  /* Compact carets for desktop - simple downward caret */
  .menu-item-has-children > a::after {
    content: "v";
    font-size: 0.625rem; /* Even smaller caret */
    margin-left: 0.125rem; /* Minimal margin */
    display: inline-block;
    transition: transform 0.3s ease;
    font-weight: bold;
    line-height: 1;
  }

  .menu-item-has-children.hover > a::after {
    transform: rotate(180deg); /* Flip upward on hover */
  }
}

/* Main navigation container adjustments */
.main-navigation {
  @apply flex-shrink min-w-0; /* Allow shrinking if needed */
}

/* Navigation wrapper with overflow handling */
.main-navigation .hidden.lg\\:block {
  /* Remove overflow-x-auto to prevent dropdown clipping */
  overflow: visible !important; /* Allow dropdowns to extend in all directions */
  scrollbar-width: none; /* Hide scrollbar in Firefox */
  -ms-overflow-style: none; /* Hide scrollbar in IE */
}

.main-navigation .hidden.lg\\:block::-webkit-scrollbar {
  display: none; /* Hide scrollbar in Webkit browsers */
}

/* Mobile logo sizing - more reasonable size */
@media (max-width: 767px) {
  .custom-logo,
  .site-branding img {
    @apply max-w-[180px] max-h-[50px]; /* Increased from 140x32 for better visibility */
  }
}

/* Tablet logo sizing - between mobile and desktop */
@media (min-width: 768px) and (max-width: 1023px) {
  .custom-logo,
  .site-branding img {
    @apply max-w-[220px] max-h-[65px]; /* Tablet-specific sizing */
  }
}

/* Mobile menu styles - Extended to cover tablet range */
@media (max-width: 1023px) {
  .main-navigation {
    @apply static;
  }

  /* Override the hidden class when mobile menu is open */
  body.mobile-menu-open .main-navigation {
    @apply block;
  }

  /* Hide desktop search icon when mobile menu is open to prevent duplication with mobile search icon */
  @media (max-width: 1023px) {
    body.mobile-menu-open .main-navigation .search-toggle {
      display: none !important;
    }
  }

  /* Dark overlay behind the menu - Applied to body */
  body.mobile-menu-open::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(4px);
    z-index: 200;
  }

  /* Prevent body scroll when mobile menu is open */
  body.mobile-menu-open {
    overflow: hidden;
    position: fixed;
    width: 100%;
    height: 100%;
  }

  .nav-menu-container {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100vw;
    height: 100vh;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s ease;
    z-index: 210;
  }

  /* Adjust for admin bar in mobile menu */
  .admin-bar .nav-menu-container {
    top: 32px; /* Standard WP admin bar height */
    height: calc(100vh - 32px);
  }

  @media screen and (max-width: 782px) {
    .admin-bar .nav-menu-container {
      top: 46px; /* WP admin bar height on mobile */
      height: calc(100vh - 46px);
    }
  }

  @media screen and (max-width: 600px) {
    .admin-bar.mobile-scrolled .nav-menu-container {
      top: 0; /* When admin bar scrolls away on mobile */
      height: 100vh;
    }
  }

  /* Ensure the header (with close button) stays above the mobile menu */
  body.mobile-menu-open .site-header {
    position: fixed !important;
    z-index: 220 !important;
  }

  /* Ensure menu toggle button is clickable when menu is open */
  body.mobile-menu-open .menu-toggle {
    position: relative;
    z-index: 225 !important;
  }

  body.mobile-menu-open .nav-menu-container {
    opacity: 1;
    pointer-events: auto;
  }

  .menu {
    background: white;
    width: 100vw;
    height: 100vh;
    overflow-y: auto;
    overflow-x: hidden; /* Prevent horizontal scroll */
    padding: 100px 1rem 2rem 1rem; /* Top padding for header space */
    margin: 0;
    position: relative;
    /* Override desktop flex layout for mobile */
    display: block !important;
    flex-direction: column !important;
    box-sizing: border-box; /* Include padding in width calculation */
  }

  /* Mobile menu items display as full-width blocks */
  body.mobile-menu-open .menu li {
    display: block !important;
    width: 100% !important;
  }

  /* Mobile menu list styling */
  .menu li {
    @apply border-b border-gray-100 last:border-b-0;
    display: block !important; /* Override any flex item styling */
    width: 100% !important;
    margin: 0 !important;
    box-sizing: border-box;
    overflow-wrap: break-word; /* Break long words */
    word-wrap: break-word; /* Fallback for older browsers */
  }

  .menu a {
    @apply block py-4 px-2 text-gray-700 hover:text-primary-blue hover:bg-gray-50 transition-all duration-200 text-base;
    text-decoration: none;
    display: block !important;
    width: 100% !important;
    box-sizing: border-box;
    white-space: normal !important; /* Allow text wrapping */
    overflow-wrap: break-word; /* Break long words */
    word-wrap: break-word; /* Fallback for older browsers */
    word-break: break-word; /* Aggressive word breaking */
    hyphens: auto; /* Add hyphens for long words */
    max-width: 100%;
    /* Ensure proper spacing for nested items */
    padding-right: 1rem !important;
  }

  .menu .current-menu-item > a,
  .menu .current_page_item > a {
    @apply text-primary-blue bg-gray-50;
  }

  .menu-item-has-children {
    @apply relative;
  }

  .menu-item-has-children > a::after {
    @apply ml-1 inline-block transition-transform duration-200;
    content: "\25BC";
  }

  .menu-item-has-children.active > a::after {
    @apply transform rotate-180;
  }

  .sub-menu {
    @apply hidden pl-4 mt-1 space-y-2;
  }

  .sub-menu.show {
    @apply block;
  }

  /* Nested submenus */
  .sub-menu .sub-menu {
    @apply pl-4; /* Additional indentation for nested levels */
  }

  /* Ensure deeply nested menu items don't cause horizontal overflow */
  .sub-menu a,
  .sub-menu .sub-menu a,
  .sub-menu .sub-menu .sub-menu a {
    max-width: 100% !important; /* Use full width of container */
    width: 100% !important; /* Ensure full width usage */
    word-break: normal !important; /* Less aggressive word breaking */
    overflow-wrap: break-word !important;
    white-space: normal !important;
    /* Add more left padding for nested levels */
    padding-left: 1.25rem !important; /* Reduced padding for more text space */
    padding-right: 1.25rem !important; /* Reduced padding for more text space */
    /* Ensure consistent font size across all levels */
    font-size: 0.875rem !important; /* Match text-sm from Tailwind */
    box-sizing: border-box !important; /* Include padding in width calculation */
    line-height: 1.5 !important; /* Improved line height for readability */
    display: block !important; /* Ensure block display */
    hyphens: auto !important; /* Enable hyphenation for better text wrapping */
  }

  /* Third level nesting */
  .sub-menu .sub-menu a {
    padding-left: 3rem !important;
  }

  /* Fourth level nesting (for extremely deep menus) */
  .sub-menu .sub-menu .sub-menu a {
    padding-left: 4rem !important;
  }

  /* Ensure submenus don't cause horizontal overflow */
  body.mobile-menu-open .sub-menu {
    width: 100% !important;
    box-sizing: border-box;
    padding-left: 2rem; /* Indentation for nested items */
    margin: 0 !important;
  }

  body.mobile-menu-open .sub-menu li {
    width: 100% !important;
    padding-left: 0 !important;
  }

  body.mobile-menu-open .sub-menu a {
    width: 100% !important;
    padding-left: 1rem !important; /* Extra indentation for submenu items */
    white-space: normal !important;
    overflow-wrap: break-word;
  }
}

/* Desktop menu styles */
@media (min-width: 768px) {
  /* Navigation responsive adjustments */
  .main-navigation .hidden.lg\\:block {
    @apply max-w-none; /* Allow navigation to use available space */
  }

  .menu {
    @apply flex-wrap; /* Allow wrapping if absolutely necessary */
    gap: 0.5rem; /* Use gap instead of space-x for better wrapping */
  }

  .menu-item-has-children {
    @apply relative;
    /* Ensure consistent positioning base for all menu items */
    position: relative !important;
  }

  /* Improved hover area that accounts for menu wrapping */
  .menu-item-has-children > a {
    @apply pb-2;
    position: relative;
    /* Add extra padding for larger click/hover area */
    padding: 0.75rem 1rem;
    margin: -0.25rem -0.5rem;
  }

  .menu-item-has-children > a::after {
    @apply ml-1 inline-block transition-transform duration-300;
    content: "\25BC";
  }

  .menu-item-has-children.hover > a::after {
    @apply transform rotate-180;
  }

  /* Create a larger hover bridge between menu item and submenu */
  .menu-item-has-children::after {
    content: "";
    @apply absolute w-full left-0 top-full;
    height: 2rem; /* Bridge to handle wrapped menus */
    pointer-events: auto; /* Important: capture mouse events */
  }

  /* Add hover tolerance area to the left and right */
  .menu-item-has-children::before {
    content: "";
    @apply absolute top-0 bottom-0;
    left: -1rem;
    right: -1rem;
    z-index: 1;
    pointer-events: auto; /* Important: capture mouse events */
  }

  .sub-menu {
    @apply absolute left-0 top-full min-w-[200px] bg-white shadow-lg rounded-md;
    padding: 0.5rem; /* Consistent padding */
    margin-top: 0.5rem; /* Position below header shadow with more space */
    width: max-content; /* Use natural width based on content */
    min-width: 200px; /* Minimum width for short items */
    max-width: 350px; /* Maximum width constraint to prevent excessive width */
    z-index: 9999 !important; /* Ensure always on top */

    /* Transition settings for immediate appearance */
    opacity: 0;
    visibility: hidden;
    transform: translateY(-3px);
    transition:
      opacity 0.1s ease,
      visibility 0s linear,
      transform 0.1s ease;
    pointer-events: none; /* Don't catch mouse events when hidden */
  }

  /* Style for menu items in submenus for better readability with wrapped text */
  .sub-menu li {
    margin-bottom: 2px;
  }

  .sub-menu li:last-child {
    margin-bottom: 0;
  }

  /* Add hover effect to menu items */
  .sub-menu a:hover {
    background-color: rgba(0, 0, 0, 0.03);
    border-radius: 4px;
  }

  /* When shown, make visible with transition */
  .sub-menu.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
    pointer-events: auto; /* Re-enable pointer events when visible */
  }

  /* Add invisible hover area around submenus for diagonal mouse movement */
  .sub-menu::before {
    content: "";
    position: absolute;
    top: -1rem;
    left: -1rem;
    right: -1rem;
    bottom: -1rem; /* Larger area below for approaching from underneath */
    z-index: -1;
    pointer-events: auto; /* Ensure it captures mouse events */
  }

  /* Handle last two items differently to prevent overflow */
  .menu > .menu-item-has-children:nth-last-child(-n + 2) > .sub-menu {
    @apply right-0 left-auto;
  }

  /* Nested submenus */
  .sub-menu .menu-item-has-children > a::after {
    content: "\25B6"; /* Right-pointing triangle for nested items */
    @apply ml-2;
  }

  /* Create hover bridge for nested submenus */
  .sub-menu .menu-item-has-children::after {
    content: "";
    @apply absolute w-16 h-full right-0 top-0;
    pointer-events: auto; /* Important: capture mouse events */
    /* Wider bridge (16px instead of 8px) for better hover detection between menus */
  }

  /* Position nested submenus */
  .sub-menu .menu-item-has-children > .sub-menu {
    @apply left-full top-0 pl-3; /* Default position */
    margin-top: 0; /* Align with the top of parent */
    margin-left: 10px; /* Larger offset to ensure no overlap with parent */
    z-index: 9999 !important; /* Ensure always on top */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Distinct shadow for better separation */
    max-width: 300px; /* Ensure consistent width for nested menus */
    width: max-content; /* Use natural width based on content */
  }

  /* Special styles for nested submenu items with long text */
  .sub-menu .sub-menu a {
    font-size: 0.875rem; /* Keep consistent font size across all levels */
    padding: 6px 10px; /* Slightly less padding for nested items */
  }

  /* Handle nested submenus for items that might overflow */
  .menu
    > .menu-item-has-children:nth-last-child(-n + 2)
    .sub-menu
    .menu-item-has-children
    > .sub-menu {
    @apply right-full left-auto pl-0 pr-3; /* Position to the left instead */
    margin-right: 10px; /* Larger offset to ensure no overlap with parent */
  }

  /* Adjust the arrow for right-aligned submenus */
  .menu
    > .menu-item-has-children:nth-last-child(-n + 2)
    .sub-menu
    .menu-item-has-children
    > a::after {
    content: "\\25C0"; /* Left-pointing triangle */
    @apply mr-2 ml-0;
  }

  .sub-menu .menu-item-has-children.hover > a::after {
    @apply transform rotate-90; /* Rotate the arrow for nested items */
  }

  .sub-menu.show {
    @apply block;
  }
}

/* 
 * Menu overflow and navigation fixes
 * Ensures proper dropdown menu display outside fixed headers
 */

/* Ensure header allows content to extend beyond its boundaries */
.site-header {
  overflow: visible !important;
  overflow-y: visible !important;
}

.header-container {
  overflow: visible !important;
  overflow-y: visible !important;
}

/* Make sure menu items with dropdowns aren't clipped */
.menu-item-has-children {
  overflow: visible !important;
}

/* Desktop menu navigation enhancements */
@media (min-width: 1024px) {
  /* Ensure proper overflow handling for navigation elements at all breakpoints */
  .site-header,
  .site-header.header-scrolled,
  .header-container {
    overflow-y: visible !important;
  }

  /* Position submenus properly and ensure visibility */
  .menu-item-has-children > .sub-menu {
    /* Position below the parent item */
    top: 100%;
    /* Ensure dropdown is visible outside header */
    z-index: 9999;
    /* Ensure no clipping */
    overflow: visible;
    display: none;
  }

  /* When showing submenus, make sure they're visible */
  .menu-item-has-children.hover > .sub-menu,
  .sub-menu.show {
    display: block !important;
  }

  /* Remove underline on hover for all navigation menu items */
  .main-navigation .menu a:hover {
    text-decoration: none !important;
  }

  /* Make background slightly darker for menu items on hover */
  .main-navigation .menu > li > a:hover {
    background-color: rgba(0, 0, 0, 0.04);
    border-radius: 4px;
  }

  /* Ensure submenu items also have darker backgrounds on hover but no underline */
  .sub-menu a:hover {
    background-color: rgba(
      0,
      0,
      0,
      0.07
    ) !important; /* Slightly darker than parent items */
    text-decoration: none !important;
    border-radius: 4px;
  }

  /* Ensure current active items maintain their styles but without underline */
  .menu .current-menu-item > a:hover,
  .menu .current_page_item > a:hover {
    text-decoration: none !important;
  }

  /* Fix for text overflow in menu items - especially for 'visiting & consulting...' links */
  .sub-menu {
    min-width: 240px !important; /* Minimum width for submenus */
    width: max-content !important; /* Adjust width based on content */
    max-width: 350px !important; /* Maximum width to prevent excessively wide menus */
  }

  /* Fix specifically for long menu links that overflow their containers */
  .sub-menu a {
    white-space: normal !important; /* Force wrapping */
    overflow-wrap: break-word !important; /* Enable word breaking */
    word-break: normal !important; /* Use standard word break rules */
    width: 100% !important; /* Use full width of container */
    line-height: 1.3 !important; /* Slightly tighter line height for wrapped text */
    display: block !important; /* Ensure block display */
    max-width: 100% !important; /* Don't exceed container width */
    hyphens: auto !important; /* Enable hyphenation for better text wrapping */
  }

  /* Adjust display of deeply nested submenus */
  .sub-menu .sub-menu {
    min-width: 220px !important; /* Slightly smaller min-width for nested menus */
  }

  /* Handle submenus for viewports narrower than 1400px */
  @media (max-width: 1400px) {
    .sub-menu {
      max-width: 280px !important; /* Narrower submenus on smaller screens */
    }

    .sub-menu a {
      font-size: 0.85rem !important; /* Smaller font size */
      padding: 8px 12px !important; /* Smaller padding */
    }
  }
}
