<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=1200, initial-scale=1.0" />
    <title>Overflow Fix Verification</title>
    <link rel="stylesheet" href="final.css?v=11" />
    <script src="force-overflow-fix.js"></script>
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        min-width: 1200px;
      }

      .test-results {
        position: fixed;
        top: 100px;
        right: 20px;
        width: 350px;
        background: white;
        border: 2px solid #333;
        padding: 15px;
        font-size: 14px;
        z-index: 2000;
        max-height: 80vh;
        overflow-y: auto;
      }

      .pass {
        color: green;
        font-weight: bold;
      }
      .fail {
        color: red;
        font-weight: bold;
      }

      .test-container {
        margin-top: 120px;
        padding: 20px;
        background: #f0f0f0;
      }

      /* Force dropdown visible for testing */
      .sub-menu {
        display: block !important;
      }

      /* Visual debugging */
      .site-header {
        border: 3px solid red;
        background: rgba(255, 0, 0, 0.1) !important;
      }
      .header-container {
        border: 3px solid blue;
        background: rgba(0, 0, 255, 0.1) !important;
      }
      .sub-menu {
        border: 3px solid purple !important;
        background: yellow !important;
        min-height: 120px !important;
      }
    </style>
  </head>
  <body>
    <header id="masthead" class="site-header">
      <div class="header-container">
        <div class="site-branding">
          <h1>Overflow Test</h1>
        </div>
        <div class="header-controls">
          <nav
            class="main-navigation flex items-center"
            style="display: flex !important"
          >
            <div class="nav-menu-container">
              <ul class="menu">
                <li class="menu-item menu-item-has-children">
                  <a href="#">Test Menu</a>
                  <ul class="sub-menu">
                    <li><a href="#">Item 1</a></li>
                    <li><a href="#">Item 2</a></li>
                    <li><a href="#">Item 3</a></li>
                    <li><a href="#">Item 4</a></li>
                  </ul>
                </li>
              </ul>
            </div>
          </nav>
        </div>
      </div>
    </header>

    <div class="test-results">
      <h3>Overflow Fix Verification</h3>
      <div id="results"></div>
      <button onclick="runTest()" style="margin-top: 10px; padding: 8px">
        Re-run Test
      </button>
    </div>

    <div class="test-container">
      <h2>Visual Test</h2>
      <p>
        The yellow dropdown should extend below the red header border without
        being clipped.
      </p>
      <p>
        Check the test results panel on the right for detailed verification.
      </p>
    </div>

    <script>
      function runTest() {
        const siteHeader = document.querySelector(".site-header");
        const headerContainer = document.querySelector(".header-container");
        const dropdown = document.querySelector(".sub-menu");

        let results = '<div style="margin-bottom: 15px;">';
        results += "<strong>CSS Overflow Tests:</strong><br>";

        // Test site-header overflow
        const siteHeaderStyles = window.getComputedStyle(siteHeader);
        const siteHeaderOverflowY = siteHeaderStyles.overflowY;
        results += `Site Header overflow-y: ${siteHeaderOverflowY} `;
        results +=
          siteHeaderOverflowY === "visible"
            ? '<span class="pass">✓ PASS</span>'
            : '<span class="fail">✗ FAIL</span>';
        results += "<br>";

        // Test header-container overflow
        const containerStyles = window.getComputedStyle(headerContainer);
        const containerOverflowY = containerStyles.overflowY;
        results += `Header Container overflow-y: ${containerOverflowY} `;
        results +=
          containerOverflowY === "visible"
            ? '<span class="pass">✓ PASS</span>'
            : '<span class="fail">✗ FAIL</span>';
        results += "<br>";

        results += "</div>";

        // Test dropdown positioning
        results += '<div style="margin-bottom: 15px;">';
        results += "<strong>Dropdown Position Tests:</strong><br>";

        const siteHeaderRect = siteHeader.getBoundingClientRect();
        const dropdownRect = dropdown.getBoundingClientRect();

        results += `Site Header height: ${Math.round(siteHeaderRect.height)}px<br>`;
        results += `Site Header bottom: ${Math.round(siteHeaderRect.bottom)}px<br>`;
        results += `Dropdown top: ${Math.round(dropdownRect.top)}px<br>`;
        results += `Dropdown bottom: ${Math.round(dropdownRect.bottom)}px<br>`;

        const extendsBelow = dropdownRect.bottom > siteHeaderRect.bottom;
        results += `Dropdown extends below header: `;
        results += extendsBelow
          ? '<span class="pass">✓ PASS</span>'
          : '<span class="fail">✗ FAIL</span>';
        results += "<br>";

        results += "</div>";

        // Overall result
        const allPassed =
          siteHeaderOverflowY === "visible" &&
          containerOverflowY === "visible" &&
          extendsBelow;

        results +=
          '<div style="padding: 10px; border: 2px solid ' +
          (allPassed ? "green" : "red") +
          '; margin-top: 10px;">';
        results += "<strong>Overall Result: ";
        results += allPassed
          ? '<span class="pass">ALL TESTS PASSED ✓</span>'
          : '<span class="fail">TESTS FAILED ✗</span>';
        results += "</strong></div>";

        document.getElementById("results").innerHTML = results;

        // Console output
        console.log("=== OVERFLOW FIX VERIFICATION ===");
        console.log(`Site Header overflow-y: ${siteHeaderOverflowY}`);
        console.log(`Header Container overflow-y: ${containerOverflowY}`);
        console.log(`Dropdown extends below header: ${extendsBelow}`);
        console.log(`Overall result: ${allPassed ? "PASS" : "FAIL"}`);
      }

      // Run test on load
      document.addEventListener("DOMContentLoaded", function () {
        setTimeout(runTest, 500);
      });
    </script>
  </body>
</html>
